┌─────────────┐     1. 建立连接     ┌─────────────┐
│   前端浏览器  │────────────────────▶│  Express 服务 │
└─────────────┘                     └──────┬──────┘
                                           │
                                           ▼
┌─────────────────────────────────────────────────────────────┐
│                        2. 接收请求                           │
│  (解析 HTTP 报文：方法、URL、头信息、请求体等)                 │
└─────────────────────────────────────────────────────────────┘
                                           │
                                           ▼
┌─────────────────────────────────────────────────────────────┐
│                     3. 中间件链式执行                        │
│  ┌────────────┐  ┌────────────┐  ┌────────────┐  ┌─────────┐ │
│  │ 日志中间件  │──▶ CORS 中间件 ──▶ 解析请求体 ──▶ 权限校验  │ │
│  │ (morgan)   │  │  (cors)    │  │(express.json)│  (自定义) │ │
│  └──────┬─────┘  └──────┬─────┘  └──────┬─────┘  └────┬────┘ │
│         │ next()        │ next()        │ next()       │ next()│
└─────────┼───────────────┼───────────────┼──────────────┼──────┘
          │               │               │              │
          ▼               ▼               ▼              ▼
┌─────────────────────────────────────────────────────────────┐
│                     4. 路由匹配                              │
│  ┌─────────────────────────────────────────────────────┐    │
│  │ 匹配规则：HTTP方法 + URL路径                          │    │
│  │ 例：POST /api/upload 匹配 app.post('/api/upload', ...) │    │
│  └───────────┬───────────────────────────────────────────┘    │
│              │ 匹配成功                                        │
└──────────────┼─────────────────────────────────────────────────┘
               │
               ▼
┌─────────────────────────────────────────────────────────────┐
│                     5. 路由处理函数                           │
│  ┌─────────────────────────────────────────────────────┐    │
│  │ 业务逻辑处理：                                        │    │
│  │ - 读取请求数据 (req.params/body/query)               │    │
│  │ - 操作数据库/文件                                    │    │
│  │ - 生成响应数据                                       │    │
│  └───────────┬───────────────────────────────────────────┘    │
│              │ 调用 res.send()/json() 生成响应                │
└──────────────┼─────────────────────────────────────────────────┘
               │
               ▼
┌─────────────────────────────────────────────────────────────┐
│                     6. 响应发送                               │
│  (封装 HTTP 响应报文：状态码、头信息、响应体)                  │
└─────────────────────────────────────────────────────────────┘
               │
               ▼
┌─────────────┐     7. 接收响应     ┌─────────────┐
│  Express 服务 │────────────────────▶│   前端浏览器  │
└─────────────┘                     └─────────────┘